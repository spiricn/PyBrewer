<html>

<head>

<title>PyBrewer</title>

<script>

function toggleRelay() {
    var xhr = new XMLHttpRequest();
    xhr.open('POST', 'rest/relay/toggle');
    
    xhr.onload = function() {
        if (xhr.status !== 200) {
            alert('toggle failed: ' + xhr.response);
        }
    };

    xhr.send()
}

function refreshStatu() {
    var xhr = new XMLHttpRequest();
    xhr.open('POST', 'rest/status');
    
    xhr.onload = function() {
        var status = JSON.parse(xhr.response);
        
        document.getElementById("ambient_temperature").innerHTML = status.ambient_temp + " C";
        
        document.getElementById("liquid_temperature").innerHTML = status.liquid_temp + " C";
        
        document.getElementById("relay_state").innerHTML = (status.relay_on ? 'ON' : 'OFF');
        
        document.getElementById("temp_control_running").innerHTML = (status.temperature_controller_running ? 'ON' : 'OFF');
        
        setTimeout(refreshStatu,
            1000)
    };

    xhr.send()
}

function toggleTempControl() {
    var xhr = new XMLHttpRequest();
    xhr.open('POST', 'rest/temperature/controller/toggle');
    
    xhr.onload = function() {
        if (xhr.status != 200) {
            alert('toggle failed: ' + xhr.response);
        }
    };
    
    xhr.send()
}

refreshStatu()


</script>


<style>
    html, body {
        background-color: black;
        width: 100%;
    }
    
    td {
        font-family: "Courier New", Times, serif;
        color: #00ff00;
        font-weight: bold;
        font-size: large;
        padding: 12px 12px 12px 12px;
    }
    table {
    margin: 0 auto;
     
    }
    
    h2 {
    text-decoration: underline;
    }
    
</style>


</head>

<body>


<table>

    <tr><td colspan=2> <h2> Temperature </h2> </td></tr>

    <tr>
        <td> Ambient temperature </td>
        <td id="ambient_temperature"> </td>
    </tr>
    
    <tr>
        <td> Liquid temperature </td>
        <td id="liquid_temperature"> </td>
    </tr>
    
    <tr><td></br></td></tr>
    <tr><td colspan=2> <h2> Relay </h2> </td></tr>
    
    <tr>
        <td> Relay state </td>
        <td id="relay_state"> </td>
        <td> <button onClick="toggleRelay()"> toggle </button> </td>
    </tr>
    
    <tr><td></br></td></tr>
    <tr><td colspan=2> <h2> Controller </h2> </td></tr>
    
    <tr>
        <td> Temperature control </td>
        <td id="temp_control_running"> </td>
        <td> <button onClick="toggleTempControl()"> toggle </button> </td>
    </tr>

    <tr>
        <td> Target temperature </td>
        <td> ${Brewer.temperatureControl.targetTemperatureCelsius} </td>
    </tr>

</table>

</body>

</html>
